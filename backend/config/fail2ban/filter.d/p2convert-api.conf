# Fail2ban filter for P2Convert API attacks

[Definition]

# Fail regex patterns for API abuse
failregex = ^<HOST> -.*"(GET|POST|PUT|DELETE) /api/.*" (4\d{2}|5\d{2}) .*$
            ^<HOST> -.*"(GET|POST|PUT|DELETE) /api/conversion/upload.*" (4\d{2}|5\d{2}) .*$
            ^<HOST> -.*"(GET|POST|PUT|DELETE) /api/conversion/status.*" (4\d{2}|5\d{2}) .*$
            ^<HOST> -.*"(GET|POST|PUT|DELETE) /api/conversion/stats.*" (4\d{2}|5\d{2}) .*$
            ^<HOST> -.*"(GET|POST|PUT|DELETE) /api/conversion/health.*" (4\d{2}|5\d{2}) .*$

# Ignore successful requests
ignoreregex = ^<HOST> -.*"(GET|POST|PUT|DELETE) /api/.*" (2\d{2}|3\d{2}) .*$

# Date pattern for log parsing
datepattern = ^%%Y/%%m/%%d %%H:%%M:%%S
