# Fail2ban filter for P2Convert DDoS attacks

[Definition]

# Fail regex patterns for DDoS detection
failregex = ^<HOST> -.*"(GET|POST|PUT|DELETE) /.*" (2\d{2}|3\d{2}|4\d{2}|5\d{2}) .*$
            ^<HOST> -.*"(GET|POST|PUT|DELETE) /api/.*" (2\d{2}|3\d{2}|4\d{2}|5\d{2}) .*$
            ^<HOST> -.*"(GET|POST|PUT|DELETE) /socket\.io/.*" (2\d{2}|3\d{2}|4\d{2}|5\d{2}) .*$

# Ignore health checks and static files
ignoreregex = ^<HOST> -.*"(GET|POST|PUT|DELETE) /health.*" (2\d{2}|3\d{2}) .*$
              ^<HOST> -.*"(GET|POST|PUT|DELETE) /.*\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot).*" (2\d{2}|3\d{2}) .*$

# Date pattern for log parsing
datepattern = ^%%Y/%%m/%%d %%H:%%M:%%S
