# Fail2ban filter for P2Convert upload abuse

[Definition]

# Fail regex patterns for upload abuse
failregex = ^<HOST> -.*"POST /api/conversion/upload.*" (413|415|422|500) .*$
            ^<HOST> -.*"POST /api/conversion/upload.*" (4\d{2}|5\d{2}) .*"multipart/form-data".*$
            ^<HOST> -.*"POST /api/conversion/upload.*" (4\d{2}|5\d{2}) .*"Content-Length: [0-9]{9,}".*$

# Ignore successful uploads
ignoreregex = ^<HOST> -.*"POST /api/conversion/upload.*" (2\d{2}|3\d{2}) .*$

# Date pattern for log parsing
datepattern = ^%%Y/%%m/%%d %%H:%%M:%%S
